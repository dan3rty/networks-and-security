# Документ по проектированию: Итеративный DNS-резолвер

## 1. Введение
Приложение представляет собой итеративный DNS-резолвер, разработанный на языке C++. Программа выполняет разрешение доменных имен в IP-адреса (IPv4/IPv6), начиная с корневых серверов, без использования флага рекурсии (`RD=0`).

## 2. Архитектура и Реализация

### Основные модули
*   **Сетевое взаимодействие:** Использование BSD сокетов (`SOCK_DGRAM`) для обмена сообщениями по протоколу UDP. Реализован контроль таймаутов.
*   **Парсинг:** Ручная распаковка DNS-пакетов с поддержкой сжатия имен (pointer 0xC0).
*   **Логирование:** Режим отладки (`-d`), демонстрирующий пошаговый процесс перехода между серверами.

### Соответствие стандарту и ограничения
Приложение реализует "Happy Path" итеративного разрешения.

1.  **Типы записей:**
    *   Поддержка запросов **A** (IPv4) и **AAAA** (IPv6).
    *   Корректная обработка **CNAME** (перезапуск цепочки разрешения).

2.  **Обработка ошибок:**
    *   Детекция RCODE (например, NXDOMAIN).
    *   Обработка таймаутов сети.

3.  **Обработка Glue Records:**
    *   Алгоритм поиска следующего сервера анализирует секцию **Additional**.
    *   Поддерживаются как IPv4, так и IPv6 адреса серверов имен (Glue).
    *   **Ограничение (Glueless delegation):** В текущей версии не реализована полная рекурсия для случаев, когда сервер имен указан в секции Authority, но его IP-адрес отсутствует в Additional. В таких случаях разрешение прерывается с сообщением об ошибке.

4.  **Флаг TC (Truncated):**
    *   Реализована **проверка и логирование** флага TC в заголовке ответа.
    *   При обнаружении флага пользователю выводится предупреждение о том, что пакет усечен. Переключение на TCP в данной версии не производится (реализован только UDP транспорт).

## 3. Алгоритм работы

1.  Установка адреса корневого сервера (`198.41.0.4`).
2.  Отправка UDP-запроса с флагом `RD=0`.
3.  Получение и валидация ответа (проверка ID, RCODE).
4.  Анализ секций:
    *   **Answer:** Если найден ответ — вывод результата.
    *   **Authority:** Секция считывается парсером для корректного смещения указателя (logging purpose only).
    *   **Additional:** Поиск IP-адреса (A или AAAA) следующего NS-сервера.
5.  Если найден Glue IP — переход на шаг 2 с новым сервером.
